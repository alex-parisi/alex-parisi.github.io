<!DOCTYPE HTML>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Alex Parisi - ESRGAN Super-Resolution</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<div id="main">
						<div class="inner">

							<!-- Header -->
								<header id="header">
                  <strong>atparisi.com</strong>
									<!--<a href="index.html" class="logo"><strong>Editorial</strong> by HTML5 UP</a>-->
									<ul class="icons">
										<li><a href="https://www.linkedin.com/in/alextparisi/" class="icon brands fa-linkedin"><span class="label">LinkedIn</span></a></li>
										<li><a href="https://github.com/alex-parisi" class="icon brands fa-github"><span class="label">GitHub</span></a></li>
									</ul>
								</header>

							<!-- Section -->
								<section>
									<header class="major">
										<h2>ESRGAN Super-Resolution</h2>
									</header>
                  <h3>Summary</h3>
                  <div class="row gtr-200">
                    <div class="col-6 col-12-medium">
                      <div class="box alt">
                        <div class="row gtr-50 gtr-uniform">
                          <div class="col-6">
                            <span class="image fit">
                              <img src="images/paint_upscaled.png" alt="">
                            </span>
                          </div>
                          <div class="col-6">
                            <span class="image fit">
                              <img src="images/esrgan-output.jpg" alt="">
                            </span>
                          </div>
                          <div class="col-6">
                            <span class="image fit">
                              <img src="images/paint_upscaled - zoom2.png" alt="">
                            </span>
                          </div>
                          <div class="col-6">
                            <span class="image fit">
                              <img src="images/esrgan-output - zoom2.jpg" alt="">
                            </span>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="col-6 col-12-medium">
                      <p>
                        <img class="image right" src="images/esrgan-original.png" alt=""/>
                        The Enhanced Super-Resolution Generative Adversarial Network, or ESRGAN, is an improvement of standard Super-Resolution Generative Adversarial Networks (SRGAN) via introduction of the Residual-in-Residual Dense Block (RRDB). Essentially, the model takes an image and upscales it by a factor of 4. The results are much cleaner than when compared to traditional methods of upscaling images.<br><br>
                        The image on the right shows the input to the ESRGAN model - a picture of a monkey's face (sorry, I'm no biologist). On the left, there are a series of images showing the output of the ESRGAN model and a comparison against generic upscaling used in Microsoft paint.<br><br>
                        On the left: the top-left image shows the upscaled version of the input picture using Microsoft Paint; the top-right image shows the super-resolution output of the ESRGAN model; the bottom-left shows a zoom-in of the upscaled version from Microsoft Paint; and the bottom-right shows a zoom-in of the super-resolution output from the ESRGAN model.<br><br>
                        The ESRGAN model was trained using images of size 128x128, so in order to upscale larger images, I divide the image into 128x128 tiles and process those with the model, and then reassemble into the larger image. You can view the project's Github page here:
                        <ul class="actions">
                          <li><a href="https://github.com/alex-parisi/tfhub-esrgan-wrapper" class="button icon brands fa-github">Github</a></li>
                        </ul>
                      </p>
                    </div>
                  </div>
                </section>
                
                <section>
                  <div class="posts">
                    <article style="width:calc(50% - 6em)">
                      <h3>Usage</h3>
                      First, install the package with pip:
                      <pre>
                        <code>pip install tfhub-esrgan-wrapper</code>
                      </pre>
                      Then, import the package:
                      <pre>
                        <code>from tfhub_esrgan_wrapper import ESRGAN</code>
                      </pre>
                      Finally, evaluate the model:
                      <pre>
                        <code>esrgan = ESRGAN()
esrgan.load_image("input.jpg")
highres_image = esrgan.evaluate()</code>
                      </pre>
                      And save the super-resolution output:
                      <pre>
                        <code>from tfhub_esrgan_wrapper import save_image
save_image(highres_image, "output.jpg")</code>
                      </pre>
                    </article>
                    
                    <article style="width:calc(50% - 6em)">
                      <h3>Results</h3>
                      <h4>Full Size</h4>
                      <div class="box alt">
                        <div class="row gtr-50 gtr-uniform">
                          <div class="col-6">
                            <i>Original<br>(1920x1080) 1080p<br></i>
                            <a class="image fit" href="images/esrgan_results_input_1.jpg">
                              <img src="images/esrgan_results_input_1.jpg" alt="">
                            </a>
                          </div>
                          <div class="col-6">
                            <i>Super-Resolution<br>(7680x4320) 4K<br></i>
                            <a class="image fit" href="images/esrgan_results_output_1.jpg">
                              <img src="images/esrgan_results_output_1.jpg" alt="">
                            </a>
                          </div>
                        </div>
                      </div>
                      <p>The image on the left is the input to the ESRGAN model, and the image on the right is the output from the model. Click them to view the full-size images.</p>
                      <h4>Zoom In</h4>
                      <div class="box alt">
                        <div class="row gtr-50 gtr-uniform">
                          <div class="col-6">
                            <i>Original<br></i>
                            <a class="image fit" href="images/esrgan_results_input_2.jpg">
                              <img src="images/esrgan_results_input_2.jpg" alt="">
                            </a>
                          </div>
                          <div class="col-6">
                            <i>Super-Resolution<br></i>
                            <a class="image fit" href="images/esrgan_results_output_2.jpg">
                              <img src="images/esrgan_results_output_2.jpg" alt="">
                            </a>
                          </div>
                          <p>The images above are a zoom-in of some ripples on the water. The results can be very impressive.</p>
                        </div>
                      </div>
                    </article>
                  </div>  
                  <br>
                  <h4>JPEG Artifacts</h4>
                  <div class="row gtr-200">
                    <div class="col-6 col-12-medium">
                      <div class="box alt">
                        <div class="row gtr-50 gtr-uniform">
                          <div class="col-6">
                            <i>Original<br></i>
                            <a class="image fit" href="images/little_me_input.jpg">
                              <img src="images/little_me_input.jpg" alt="">
                            </a>
                          </div>
                          <div class="col-6 col-12-medium">
                            <i>Super-Resolution<br></i>
                            <a class="image fit" href="images/little_me_output.jpg">
                              <img src="images/little_me_output.jpg" alt="">
                            </a>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="col-6 col-12-medium">
                      <p>Although this image is an extreme example of JPEG compression, even artifacts that may be invisible to the naked eye (until closer inspection by zooming in on the image) can interfere with the ESRGAN model.</p>
                      <p>While the ESRGAN model shows impressively results, it is not perfect. As shown to the left (me in highschool), if there are distortions or artifacts (like those typically present in JPEG compression), the ESRGAN model will only amplify those distortions. Because of this, it is imperative to work with images that contain as little distortions as possible.</p>
                      <p>These distortions are typically a result of JPEG compression, which over time introduces more and more artifacts into an image. This is because JPEG compression is <i>lossy</i>, and not all of the original image information is preserved.</p>
                      <p>Although the original picture was downloaded long ago, I can guess a couple of things: the original image was probably a screen shot of a sample displayed on a school photography website to avoid paying for it. After the original image was taken, it was probably compressed once for storage on the web-hosting service, and then is possibly compressed again when displayed on the webpage. When saving the screen shot as a JPEG, the image is compressed even further. All these layers of compression introduce significant distortions that the ESRGAN model only amplifies.</p>
                    </div>
                  </div>
                  <br>
                  <h4>Stitching Distortions</h4>
                  <div class="row gtr-200">
                    <div class="col-6 col-12-medium">
                      <p>Because the ESRGAN model was trained on images of size 128x128, I convert the input image into separate 128x128 tiles to process individually by the model. Because of this, the borders of each tile will not align with its neighbors. This introduces what I will be calling stitching distortion.</p>
                      <p>The two images on the right show examples of stitching distortion occuring on the border of four 128x128 tiles. The stitching distortion, like the distortions introduced in JPEG compression, are typically not visible until closer inspection via zoom-in.</p>
                      Currently, I can think of two ways to minimize or even eliminate these distortions:
                      <ol>
                        <li>Interpolate the regions near border intersections</li>
                        <li>Increase the tile size in all directions during model evaluation, but then truncate the image again back to 128x128. This should give the model some information about the edges.</li>
                      </ol>
                    </div>
                    <div class="col-6 col-12-medium">
                      <div class="box alt">
                        <div class="row gtr-50 gtr-uniform">
                          <div class="col-6">
                            <i>Example 1<br></i>
                            <a href="images/esrgan_stitching_1.png" class="image fit">
                              <img src="images/esrgan_stitching_1.png" alt="">
                            </a>
                          </div>
                          <div class="col-6">
                            <i>Example 2<br></i>
                            <a href="images/esrgan_stitching_2.png" class="image fit">
                              <img src="images/esrgan_stitching_2.png" alt="">
                            </a>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </section>
                
                <section>
                  <h3>How It Works</h3>
                  <h4>Generator and Discriminator (GAN)</h4>
                  <p>
                    <img class="image right" src="images/ssresnet.PNG" alt="" style="max-width:60%"/>
                    The ESRGAN model is a modification of the SSResNet generator network pictured on the right. The "Basic Block" used in the SSResNet network is modified by removing all batch-normalization layers, and then combining the remaining convolution layers into multi-level residual and dense connections.
                  </p>
                  <br>
                  <p>
                    <img class="image left" src="images/rrdb.PNG" alt="" style="max-width:50%"/>
                    The image to the left shows a detail of the modified Basic Block, called the Residual-in-Residual Dense Block (RRDB). All of the Basic Blocks in the SSResNet are replaced with RRDB units.
                  </p>
                  <br><br>
                  <p>
                    <img class="image right" src="images/ssresnet_discriminator.PNG" alt="" style="max-width:60%"/>
                    The image to the right shows the network architecture for the discriminator - it follows the typical design standard for image classifiers and uses a variety of convolution and dense layers.
                  </p>
                  <br><br>
                  <h4>Tile Processing</h4>
                  <p>Because the ESRGAN model is trained on images of size 128x128, any images larger than that are divided into tiles and processed individually. This process is what most likely is introducing the stitching distortion, so this method needs to be revisited.</p>
                  
                </section>
                
                <section>
                  <h3>References</h3>
                  <p>[1] <a href="https://arxiv.org/pdf/1809.00219.pdf">Xintao Wang, Ke Yu, Shixiang Wu, Jinjin Gu, Yihao Liu, Chao Dong, Chen Change Loy, Yu Qiao, Xiaoou Tang. ESRGAN: Enhanced Super-Resolution Generative Adversarial Networks. To appear in ECCV, 2018.</a></p>
                  <p>[2] <a href="https://arxiv.org/abs/1609.04802">Christian Ledig, Lucas Theis, Ferenc Huszar, Jose Caballero, Andrew Cunningham, Alejandro Acosta, Andrew Aitken, Alykhan Tejani, Johannes Totz, Zehan Wang, Wenzhe Shi. Photo-Realistic Single Image Super-Resolution Using a Generative Adversarial Network. In CVPR, 2017.</a></p>
                  <p>[3] <a href="https://www.tensorflow.org/hub/tutorials/image_enhancing">https://www.tensorflow.org/hub/tutorials/image_enhancing</a></p>
                </section>

						</div>
					</div>

				<!-- Sidebar -->
					<div id="sidebar">
						<div class="inner">
							<!-- Menu -->
								<nav id="menu">
									<header class="major">
										<h2>Menu</h2>
									</header>
									<ul>
										<li><a href="index.html">Homepage</a></li>
                    <li><span class="opener">Style Transfer</span>
                      <ul>
                        <li><a href="styletransfer.html">Web App</a></li>
                        <li><a href="styletransfer-info.html">Project Info</a></li>
                      </ul>
                    </li>
                    <li><a href="dcgan-info.html">DCGAN Face Generator</a></li>
                    <li><a href="chess-cnn-info.html">Chessboard CNN</a></li>
                    <li><span class="opener active" style="color:#f56a6a">ESRGAN Super-resolution</span>
                      <ul>
                        <li><a href=#>Web App</a></li>
                        <li><a href="esrgan-info.html"  style="color:#f56a6a">Project Info</a></li>
                      </ul>
                    </li>
									</ul>
								</nav>

							<!-- Footer -->
								<footer id="footer">
									<p>Last Updated: 02/03/2022</p>
								</footer>

						</div>
					</div>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>
